#!/usr/bin/env bash


# Filesystem
alias rm='rm -i'

# alternatives
alias ll='exa --long --header --git -a'
alias cat='bat'
alias vim='nvim'


# Network
alias whatport='what_port'
alias killport='kill_port'


# SSH
alias sshgen='ssh-keygen -t rsa'
alias sshkey='pbcopy < ~/.ssh/id_rsa.pub'
alias s='kitty +kitten ssh'


# conveniences
alias easytimenow='date +%Y%m%d_%H%M_%s'
alias prettyjson='python -m json.tool'
alias nospace='egrep -v "^#|^[[:space:]]*$"'
alias no_commments_space='egrep -v "^;|^#|^[[:space:]]*$"'
alias pwdtail='pwd | rev | cut -d/ -f1-2 | rev'


# Git
alias git_config='/usr/bin/git --git-dir=$HOME/.cfg/ --work-tree=$HOME'
alias git_credentials_show='echo -e "\n# git credentials (helper)";git credentials.helper;echo -e "\n# git credentials (global)";git credentials.global;echo -e "\n# git credentials (local)";git credentials.local'
alias git_find_branches_for_hash='git branch -a --contains'
alias tower='gittower git rev-parse --show-toplevel'

# alias nah='git reset --hard; git clean -df' # Gone forever - Reset to last commit and remove untracked files and directories.
alias nah='try nope - nah is too dangerous'

# Recover with git reflog - Reset to last commit and remove untracked files and directories.
alias nope='git reset --hard'

# show git history visually
alias gittree='git log --branches --remotes --tags --graph --pretty=format:"%Cred%h%Creset -%C(auto)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset" --abbrev-commit --date=relative'

# debug git
alias git_debug="GIT_TRACE=true GIT_CURL_VERBOSE=true GIT_SSH_COMMAND=\"ssh -vvv\" GIT_TRACE_PACK_ACCESS=true GIT_TRACE_PACKET=true GIT_TRACE_PACKFILE=true GIT_TRACE_PERFORMANCE=true GIT_TRACE_SETUP=true GIT_TRACE_SHALLOW=true git $@"

# Auto Complete
if [ -f $(brew --prefix)/etc/bash_completion ]; then
. $(brew --prefix)/etc/bash_completion
fi

[[ -r "/usr/local/etc/profile.d/bash_completion.sh" ]] && source "/usr/local/etc/profile.d/bash_completion.sh"


# Brew
alias bsl='sudo brew services list && brew services list'


# Get VSCode extensions
alias codeextensions='code --list-extensions | xargs -L 1 echo code --install-extension'
alias subl=code # no sublime - vscode only

# Defaults
# Show/Hide hidden files in Finder
alias showhidden='echo "Use \"shift+cmd+.\" instead."'
alias hidehidden='echo "Use \"shift+cmd+.\" instead."'


# Force empty the trash
alias forceempty='sudo rm -rf ~/.Trash; sudo rm -rf /Volumes/*/.Trashes;'
alias ejectdisc='drutil tray eject'


# Java JEnv - jenv http://www.jenv.be/
# This is a non standard alias to set JAVA_HOME based on jenv environment.
alias jenv_set_java_home='export JAVA_HOME="$HOME/.jenv/versions/$(jenv version-name)"'


# VMWare Tools
alias ovftool='/Applications/VMware\ Fusion.app/Contents/Library/VMware\ OVF\ Tool/ovftool'
alias vmnet-cli='/Applications/VMware\ Fusion.app/Contents/Library/vmnet-cli'


# Jetbrains
alias pstorm='phpstorm'
alias diff_with_phpstorm='phpstorm diff'
alias smartgit="launchSmartGit $1"


# Docker
alias dock_prune='docker container prune'


# Vagrant
alias vagrant='HOMESTEADVM='\''centos'\'' vagrant'
alias vglob='vagrant global-status --prune 2>/dev/null | egrep -i --color=always "^.*$(pwd)[ ]*$|$"'
alias vush='vagrant up && vssh'
alias vnoprov='vagrant up --no-provision 2>&1 | grep -v VAGRANTFILE_API_VERSION | grep already && vagrant reload --no-provision'
#alias v_glob='vagrant global-status --prune 2>&1 | grep -v VAGRANTFILE_API_VERSION | egrep -i --color=always "^.*$(pwd).*$|$"'



# JS Node NPM PNPM YARN
alias fixjs='rm -rf node_modules/;npm cache clear --force && npm install'
alias rebuildjs='npmlist rebuilt_pre; rm -f package-lock.json && echo "⚡️ package-lock.json removed";npm cache clear --force && echo "⚡️ npm cache cleared";npm install;npmlist rebuilt;echo "⚡️ done: see rebuilt_pre"'
alias reinstalljs='npmlist installed_pre; npm cache clear --force && echo "⚡️ npm cache cleared";npm ci;npmlist installed;echo "⚡️ done: see installed_pre"'
alias revertjs='npmlist reverted_pre; git checkout package-lock.json && echo "⚡️ package-lock.json restored to git version";npm cache clear --force && echo "⚡️ npm cache cleared";npm ci;npmlist reverted;echo "⚡️ done: see reverted_pre"'
alias ng='npm list -g --depth=0'
alias nl='npm list --depth=0'
alias switch_js='nvm'
alias pn='pnpm'


# PHP Laravel Valet
alias sphp70='time switch_php 7.0 prompt'
alias sphp72='time switch_php 7.2 prompt'
alias sphp73='time switch_php 7.3 prompt'
alias sphp74='time switch_php 7.4 prompt'
alias sphp80='time switch_php 8.0 prompt'
alias sphp81='time switch_php 8.1 prompt'
alias sphp82='time switch_php 8.2 prompt'

alias vlsi='valet link && valet secure && valet isolate'

alias php_version='php -r "echo PHP_VERSION;" | cut -d. -f-2' # current php version


# Laravel
alias art='php artisan'
alias artisan='php artisan'
alias tinker='php artisan tinker'
alias sail='bash vendor/bin/sail' # docker

# composer
alias cgs='composer global --no-interaction show -D'

# PhpUnit
alias phpunit='/usr/local/bin/phpunit'
alias phpunit='vendor/bin/phpunit --log-junit scratch/phpunit_release_report.$(date "+%Y_%m_%d.%H%M%S").xml'
# support env var 'phpunitpart' as part of the filename
alias phpunit='vendor/bin/phpunit --log-junit $(echo ${phpunitdir:-scratch})/phpunit_$(echo ${phpunitpart:-report}).xml'

# pest
alias pest='./vendor/bin/pest'

alias phpspec='/usr/local/bin/phpspec'

# xDebug
alias xdebug_disable='xdbgfile=$(php -m | grep Xdebug -q && php --ini | grep xdebug) && [ -n "$xdbgfile" ] && mv $xdbgfile "${xdbgfile}"_disabled || echo "xdebug is not enabled"'
alias xdebug_restore='incpath=$(php --ini | grep "Scan for additional .ini files" | cut -d: -f2 | xargs) && [ -n "$incpath" ] && xdbgfile=$(ls "${incpath}/"xdebug*disabled) && [ -n "$xdbgfile}" ] && mv $xdbgfile "${incpath}/xdebug.ini" || echo "cannot determine php ini include path"'

# PHPDeployer - https://deployer.org
alias dep='vendor/bin/dep'                    # no global install - (composer 2 issue) - use project's vendor install.
alias prov='APP_ENV=deployer dep -f=prov.php' # custom deployer command for provisioning

# https://github.com/ibraheemdev/modern-unix

alias modern-unix='echo bat cheat tldr lsd dog curlie duf dust gping mcfly gtop rg - aka ripgrep'

# postgres
alias pgdbs="psql -l -t | cut -d'|' -f1 | egrep -v 'postgres|template' | xargs"

# update xcode tools
alias updatexcode='xcode-select --install'

# Check for running webapps (sveltekit, vite, etc)
alias listeningwebapps='lsof -i -n -P | grep node'

# Go to project locations
alias zn="cd \$HOME/Workspace/NSS"
alias zc="cd \$HOME/Workspace/CCS"
alias zb="cd \$HOME/Workspace/l3-services-bomb"
alias zz="cd \$HOME/Projects/Workspace"
alias zd="cd \$HOME/dotfiles"

# Zellij
alias zj="zellij"

alias resettty="printf '\e[?2004l'"
